# AutoPR Configuration
# Run `ap init` for interactive setup, or copy this file and customize.
#
# Tokens: store in ~/.config/autopr/credentials.toml or set env vars
# (GITHUB_TOKEN, GITLAB_TOKEN, SENTRY_TOKEN, AUTOPR_WEBHOOK_SECRET)
#
# Data files (DB, repos) default to ~/.local/share/autopr/
# State files (logs, PID) default to ~/.local/state/autopr/
# Override with XDG_DATA_HOME / XDG_STATE_HOME or set paths explicitly below.
# Run `ap paths` to see resolved locations.

# db_path = "/custom/path/autopr.db"     # default: ~/.local/share/autopr/autopr.db
# repos_root = "/custom/path/repos"      # default: ~/.local/share/autopr/repos
# log_file = "/custom/path/autopr.log"   # default: ~/.local/state/autopr/autopr.log
log_level = "info"                        # debug, info, warn, error

[daemon]
webhook_port = 9847
# webhook_secret = ""      # Set via AUTOPR_WEBHOOK_SECRET env var
max_workers = 3
max_iterations = 3
sync_interval = "5m"
# pid_file = "/custom/path/autopr.pid"   # default: ~/.local/state/autopr/autopr.pid
# auto_pr = false               # Set true to auto-create PRs after tests pass

# [sentry]
# base_url = "https://sentry.io"  # uncomment for self-hosted Sentry

[llm]
provider = "claude"  # claude or codex

[notifications]
# webhook_url = "https://example.com/hook"                     # generic JSON webhook
# slack_webhook = "https://hooks.slack.com/services/..."       # Slack incoming webhook
# desktop = true                                                # macOS desktop notifications
# triggers = ["needs_pr", "failed", "pr_created", "pr_merged"]
# Set triggers = [] to disable all notifications.

# ─── Issue Gating Defaults ───────────────────────────────────────────────────
#
# By default, AutoPR only processes issues that are explicitly opted-in:
#
#   GitHub / GitLab:  include_labels defaults to ["autopr"]
#                     → only issues with the "autopr" label are processed
#                     → exclude_labels defaults to ["autopr-skip"]
#                     → exclude wins if include and exclude labels both match
#                     → set include_labels = [] and exclude_labels = []
#                       to process ALL issues (opt-out)
#
#   Sentry:           assigned_team defaults to "autopr"
#                     → only issues assigned to the #autopr team are processed
#                     → set assigned_team = "" to process ALL issues (opt-out)
#
# These defaults prevent accidentally flooding the job queue with every open
# issue on first start. Label an issue "autopr" (or assign to #autopr in
# Sentry) when you want AutoPR to work on it.
# ──────────────────────────────────────────────────────────────────────────────

# Project definitions — add one [[projects]] block per project.
[[projects]]
name = "my-project"
repo_url = "https://gitlab.com/myorg/my-project.git"
test_cmd = "make test"
base_branch = "main"

  [projects.gitlab]
  base_url = "https://gitlab.com"
  project_id = "12345"
  # include_labels = ["autopr"]  # DEFAULT — only issues labeled "autopr" are processed
  # exclude_labels = ["autopr-skip"] # DEFAULT — issues labeled "autopr-skip" are skipped
  # include_labels = ["bug"]     # custom: only process issues labeled "bug"
  # exclude_labels = ["blocked"]   # custom: skip issues labeled "blocked"
  # include_labels = []           # opt-out: process ALL open issues (no label gating)
  # exclude_labels = []           # opt-out: disable default skip gate

  # [projects.github]
  # owner = "myorg"
  # repo = "my-project"
  # include_labels = ["autopr"]  # DEFAULT — only issues labeled "autopr" are processed
  # exclude_labels = ["autopr-skip"] # DEFAULT — issues labeled "autopr-skip" are skipped
  # include_labels = []           # opt-out: process ALL open issues (no label gating)
  # exclude_labels = []           # opt-out: disable default skip gate

  # [projects.sentry]
  # org = "myorg"
  # project = "my-project"
  # assigned_team = "autopr"     # DEFAULT — only issues assigned to #autopr team
  # assigned_team = "my-team"    # custom: only issues assigned to #my-team
  # assigned_team = ""            # opt-out: process ALL unresolved issues (no team gating)

  # Override default LLM prompts with custom markdown files:
  # [projects.prompts]
  # plan = "/path/to/plan.md"
  # implement = "/path/to/implement.md"
  # code_review = "/path/to/code_review.md"
